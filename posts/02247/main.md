---
Keywords: コマンド,open,TukubaiはTukubaとちゃうんやで〜,シェル芸
Copyright: (C) 2017 Ryuichi Ueda
---

# <!--:ja-->タブ・スペース問題に対するopen usp Tukubaiの対応および余計な一言<!--:-->
<!--:ja--><a href="http://blog.ueda.asia/?p=2157" title="SI業界がIT化してないとか酷いことを言ってしまった" target="_blank">やっと確変が終わりました。</a>あまり釣りに走らず、しっかり技術の話を書いておきます。検索で「Tukubai、スペース、タブ」でこのサイトに来てしまった人がいたので、ちゃんと説明しなければならんと。ただ、これはオープン版に対する私の解釈ですので、会社は関係ありません。<br />
<br />
知ってる人は知っていて、私もいろんなところで説明を求められるのですが、<a href="https://github.com/usp-engineers-community/Open-usp-Tukubai" target="_blank">Open usp Tukubai</a>はスペースでデータを区切ります。<br />
<br />
<!--:--><!--:en-->やっと確変が終わりました。技術の話を書いておきます。検索で「Tukubai、スペース、タブ」でこのサイトに来てしまった人がいたので、ちゃんと説明しなければならんと。ただ、これはオープン版に対する私の解釈ですので、会社は関係ありません。<br />
<br />
知ってる人は知っていて、私もいろんなところで説明を求められるのですが、Open usp Tukubaiはスペースでデータを区切ります。<br />
<br />
ということはスペースを入れたかったらアンダースコアなどを代替せねばなりません。これがcsvにしろとか、tsv（タブ区切り）にしろとか、いろいろ言われる原因になってるわけです。普通に聞いてくれるならいいのですが、時間がないのに滔々と持論を並べる人がたまにいるものですから、うるさいと口に出してしまって互いに血まみれになることがあるわけです。<br />
<br />
<h2>理由1: データのバグ防止</h2><br />
<br />
<br />
catした時にタブとスペースは区別がつきません。これがシェル芸的な作業の敵になります。<br />
<br />
<h2>理由2: 普通のコマンドも大概スペース区切りのデータを扱う</h2><br />
<br />
残念ながらコマンドは英語圏で発達したので、テキスト処理系のコマンドは単語がスペース区切りになっていることが前提になってます。open usp Tukubaiもそれに合わせてスペース区切りです。<br />
<br />
<h2>結局・・・</h2><br />
<br />
人の扱う文書やデータを扱っている以上、たとえスペースをアンダースコアに変換が必要であっても、今のところopen usp Tukubaiはスペース区切りを選んでいます。常に人の書くデータ、人の読むデータを扱う上では、そのような選択もお認めいただきたく。<br />
<br />
<br />
夕飯。<!--:--><!--more--><!--:ja--><br />
<br />
[bash]uedambp:~ ueda$ cat hoge.sp<br />
a b c<br />
d e f<br />
uedambp:~ ueda$ tarr hoge.sp <br />
a<br />
b<br />
c<br />
d<br />
e<br />
f<br />
uedambp:~ ueda$ cat hoge.tab ←タブ区切りファイル<br />
a	b	c<br />
d	e	f<br />
###tarr（単語を縦に並べる）はtab区切りだと効かない###<br />
uedambp:~ ueda$ tarr hoge.tab<br />
a	b	c<br />
d	e	f<br />
###delfは即死（ちゃんとエラー処理を実装しないといけないとは思いつつ・・・放置！）###<br />
uedambp:~ ueda$ delf 2 hoge.tab <br />
Traceback (most recent call last):<br />
 File &amp;quot;/usr/local/bin/delf&amp;quot;, line 149, in &amp;lt;module&amp;gt;<br />
 op.output(tokens)<br />
 File &amp;quot;/usr/local/bin/delf&amp;quot;, line 80, in output<br />
 tokens[i] = None<br />
IndexError: list assignment index out of range<br />
###ただしselfだけはタブを受け付けるという・・・（未定義動作）###<br />
uedambp:~ ueda$ self 2 hoge.tab <br />
b<br />
e<br />
[/bash]<br />
<br />
ということはスペースを入れたかったらアンダースコアなどを代替せねばなりません。これがcsvにしろとか、tsv（タブ区切り）にしろとか、いろいろ言われる原因になってるわけです。普通に聞いてくれるならいいのですが、こちらが聞いてもないのに滔々と持論を並べる人がたまにいるものですから、うるさいと口に出してしまって互いに血まみれになり、汗まみれになり、友情が生まれることがあるわけです。ない。<br />
<br />
<h2>理由1: データのバグ防止</h2><br />
<br />
<span style="color:red">catした時にタブとスペースは区別がつきません。これが理由の90%です。</span>目視できないものはシェル芸的な作業の敵になります。いや、目grepやれとかそういうことでなく・・・。特に大きなスペース区切りのデータを扱っていて、中にタブがあるとわけが分からん出力が出てきて困るわけですが、タブが原因だとなかなか気づかないで悩むということはたまにあります。<br />
<br />
・・・ただまあ、コードではタブ使っちゃいますけど。<br />
<br />
<h2>理由2: 普通のコマンドも大概スペース区切りのデータを扱う</h2><br />
<br />
残念ながらコマンドは英語圏で発達したので、テキスト処理系のコマンドは単語がスペース区切りになっていることが前提になってます。open usp Tukubaiもそれに合わせてスペース区切りです。タブもだいたい区切りとして認識してくれる場合もあるのですが、そしたら空白区切りとタブ区切りの混ざったtsvとかはオプションで区切り文字を指定しなければならず扱いが面倒になります。それから、trとかsedを使おうとしたら結構タブがまざっていると面倒だったりします。<br />
<br />
ちょっと話が違うかもしれませんが、fstabでタブを使ってしまってマッシーンが再起動しなくなった人って、どれくらいいますかね？<br />
<br />
<h2>結局・・・</h2><br />
<br />
人の扱う文書やデータを扱っている以上、たとえスペースをアンダースコアに変換が必要であっても、今のところopen usp Tukubaiはスペース区切りを選んでいます。常に人の書くデータ、人の読むデータを扱う上では、そのような選択もお認めいただきたく。<br />
<br />
しかし、Open版の作りは簡素で基本的に言語のsplitみたいな関数を使って単語を区切る作りになっているので、使う言語（今のところPython、今Haskell版構築中）によってはタブをサポートしてしまうかもしれません。ただ、一応未定義動作といたします。<br />
<br />
しかしこう見ると、タブって便利なんだけど罪作りですね。タブインデントとスペースインデント戦争とか・・・。<br />
<br />
<br />
夕飯。<!--:-->
